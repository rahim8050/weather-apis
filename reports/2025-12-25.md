### Daily report — Thu, Dec 25, 2025 (EAT)

**Done**

* **CI unblocked and green:** fixed the `mypy_django_plugin` CI failure where Django initialization crashed due to `django_extensions` being referenced in `INSTALLED_APPS` but missing from the CI dependency install. `python -m mypy .` now runs successfully in pipeline.
* **Docs + schema endpoints implemented and verified (drf-spectacular):**

  * OpenAPI schema: `/api/schema/`
  * Swagger UI: `/api/docs/`
  * ReDoc: `/api/redoc/`
* **Docs/schema hardened at the reverse-proxy layer (Nginx + Apache):** restricted access to the schema and docs endpoints so they are **not publicly browsable** (blocked at the proxy). This prevents external users from doing API reconnaissance via Swagger/ReDoc/schema, including discovering auth/password-related endpoint shapes.
* **Reverse-proxy validation:** traced and resolved the “works locally vs fails via proxy/remote host” friction (host/proxy headers/allowed hosts type issues) and confirmed the project serves correctly through the reverse proxy route (real-world verification beyond localhost).
* **Integration proof points observed:** confirmed API key flow in logs (key created via `/api/v1/keys/` and successful authenticated access to integration ping).

**In progress**

* **Nextcloud integration signing/HMAC hardening:** integration requests are reaching the HMAC/integration layer; remaining work is aligning edge-case behavior (canonicalization, nonce/timestamp rules, and exact status codes) to the expected contract and tests.

**Next**

* Finalize HMAC contract behavior and tests:

  * canonical query ordering
  * timestamp window enforcement
  * nonce replay protection
  * unknown client id behavior
  * constant-time signature compare
  * strict `403/200` responses for each failure mode
* Add a short doc section: reverse-proxy requirements for docs/schema access (headers + access restrictions) and how Nextcloud should call the integration endpoints.

**Blockers / risks**

* Reverse proxy header forwarding (`Host`, `X-Forwarded-Proto`, etc.) can cause misleading failures (docs/auth look broken) if not consistent.
* Integrations are mounted in two places:

  * `/api/v1/integration/`
  * `/api/v1/integrations/`
    Both include the same `integrations.urls` — this is fine, but tests and Nextcloud configuration must consistently use one to avoid confusion.

**Links**

* **CI run (green):** [https://github.com/rahim8050/weather-apis/actions/runs/20507643676](https://github.com/rahim8050/weather-apis/actions/runs/20507643676)
* **Service routes (from `config/urls.py`):**

  * Home: `/`
  * Admin: `/admin/`
  * Schema: `/api/schema/`
  * Swagger UI: `/api/docs/`
  * ReDoc: `/api/redoc/`
  * Auth: `/api/v1/auth/`
  * API keys: `/api/v1/keys/`
  * Integrations: `/api/v1/integration/` and `/api/v1/integrations/`
