### Daily report — Fri, Dec 26, 2025 (EAT)

**Done**

* **Integration endpoint security behavior confirmed (default-deny):** `GET /api/v1/integration/ping/` correctly returns **401 Unauthorized** when called without credentials and includes `WWW-Authenticate: X-API-Key`, confirming the API-key gate is active.
* **API key auth path verified end-to-end:** successful authenticated access to the integration ping endpoint is observable via logs (key created via `/api/v1/keys/` and subsequent `api_key.auth.success` reaching the integration view).
* **Reverse-proxy hardening headers verified on DRF responses:** responses include security headers such as `X-Frame-Options: DENY`, `X-Content-Type-Options: nosniff`, and strict referrer / cross-origin isolation policies, confirming the proxy layer is enforcing baseline browser protections.
* **Server-to-server integration plumbing stabilized:** DRF is now in the “machine handshake with receipts” phase — requests traverse proxy → DRF auth → integration route reliably enough to proceed to the Nextcloud caller implementation.

**In progress**

* **Nextcloud integration signing / HMAC hardening:** HMAC/integration tests and edge cases are being aligned to the final contract (canonicalization rules, nonce/timestamp behavior, and exact status codes per failure mode) so the Nextcloud app can generate the same canonical string and pass validation consistently.

**Next**

* Finalize HMAC contract behavior and tests:

  * canonical query ordering
  * strict timestamp window enforcement (clock skew tolerance defined)
  * nonce replay protection
  * unknown `client_id` handling
  * constant-time signature comparison
  * strict, predictable `403/200` responses per failure mode
  * rotation safety: accept **current + previous** secrets during overlap to avoid outages
* Add a short doc section: Nextcloud → DRF integration contract (required headers, canonical string rules, and expected responses) plus reverse-proxy requirements that can break integrations if misconfigured.

**Blockers / risks**

* **Proxy header forwarding drift:** inconsistent `Host` / `X-Forwarded-Proto` / forwarding rules can cause “looks broken” failures that are actually proxy-related (auth/docs behavior, redirects, or host validation).
* **Endpoint consistency risk:** ensure Nextcloud and tests consistently target the same integration base path (avoid mixing similar mounts like `/api/v1/integration/` vs `/api/v1/integrations/` if both exist in the project), or you’ll get false negatives that look like auth bugs.

**Links**

* **Integration ping:** `/api/v1/integration/ping/`
* **API keys:** `/api/v1/keys/`
* **Integration base:** `/api/v1/integration/` (use this consistently from Nextcloud unless you intentionally standardize another mount)

